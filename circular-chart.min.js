/*!
 * Circular-Chart
 * Version: 1.0.0
 *
 * Copyright 2017 Wolfgang Kurz
 * Released under the MIT license
 * https://github.com/WolfgangKurz/Circular-Chart
 */
 "use strict";
 window.circular=function(t){var e=!1,l=function(t,r,i){void 0===i&&(i=!0),e||(e=!0,t.width=parseInt(window.getComputedStyle(t.parentNode).getPropertyValue("width")),i&&window.addEventListener("resize",function(){l(t,r,!1)}),"function"==typeof r&&r(),e=!1)},r=["rgb(48,105,191)","rgb(163,191,48)","rgb(191,91,48)","rgb(191,163,48)","rgb(120,48,191)","rgb(191,48,48)","rgb(1,51,129)","rgb(96,123,0)"];l(t,function(){var e=t.getContext("2d"),l=Math.PI,i=[];e.translate(0,-.5),function(){for(var e=t.getAttribute("data-chart").split(";"),l=0;l<e.length;l+=3)i.push({name:e[l],value:parseFloat(e[l+1]),color:0==e[l+2].length?r[l/3%r.length]:e[l+2]});i=i.sort(function(t,e){return e.value-t.value})}();var a={x:0,y:0,w:t.clientWidth,h:t.clientHeight};e.fillStyle="#FFFFFF",e.fillRect(a.x,a.y,a.w,a.h),e.lineWidth=.6;var n=Math.min(16,(a.h-20)/i.length-10);if(e.font=n+"px Arial",e.textBaseline="hanging",a.w>=a.h){var o=2*a.w/3,h=9*Math.min(o,a.h)/10,f=-l/2,u=0,v=0,c=[],g=0;for(var s in i)u+=i[s].value;for(var s in i){var d=" - "+i[s].value.toString()+"   ("+(Math.round(1e4*i[s].value/u)/100).toString()+" %)",w=i[s].name+d,x=e.measureText(w).width;c.push({text:w,width:x}),g=Math.max(g,x+3*n/2)}for(var s in i){var y=o/2,S=a.h/2,b=i[s].value/u*2*l;(p=function(){e.fillStyle=i[s].color,e.beginPath(),e.arc(y,S,h/2,f,f+b),e.lineTo(y,S),e.closePath()})(),e.fill(),p(),e.stroke(),f+=b}M=a.w-g-10,e.fillStyle="rgba(255, 255, 255, 0.66)",e.fillRect(M-10,0,g+20,i.length*(n+10)+10);for(var s in i)e.fillStyle=i[s].color,e.fillRect(M,v+10,n,n),e.strokeRect(M,v+10,n,n),e.fillStyle="#000",e.fillText(c[s].text,M+3*n/2,v+10+2),v+=n+10}else{var m=2*a.h/3,h=9*Math.min(m,a.h)/10,f=-l/2,u=0,v=0,c=[],g=0;for(var s in i)u+=i[s].value;for(var s in i){var d=" - "+i[s].value.toString()+"   ("+(Math.round(1e4*i[s].value/u)/100).toString()+" %)",w=i[s].name+d,x=e.measureText(w).width;c.push({text:w,width:x}),g=Math.max(g,x+3*n/2)}for(var s in i){var y=a.w/2,S=a.h/3+h/2,b=i[s].value/u*2*l,p=function(){e.fillStyle=i[s].color,e.beginPath(),e.arc(y,S,h/2,f,f+b),e.lineTo(y,S),e.closePath()};p(),e.fill(),p(),e.stroke(),f+=b}var M=a.w-g-10;e.fillStyle="rgba(255, 255, 255, 0.66)",e.fillRect(M-10,0,g+20,i.length*(n+10)+10);for(var s in i)e.fillStyle=i[s].color,e.fillRect(M,v+10,n,n),e.strokeRect(M,v+10,n,n),e.fillStyle="#000",e.fillText(c[s].text,M+3*n/2,v+10+2),v+=n+10}})};
